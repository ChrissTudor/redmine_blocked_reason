<% if issue.blocked_reason.nil? %>
  <%=  button_tag(type: 'button', id: 'block_issue_button') do %>
    <%= content_tag(:strong, 'Block Issue') %>
  <% end %>
  <div id='blocked_reason_form' style='display:none;'>
    <%= form_for BlockedReason.new do |f| %>
      <%= f.hidden_field :issue_id, value: issue.id %>
      <div class="blocked-field-group-left">
        <%= f.label 'Reason: ' %><br />
        <%= f.fields_for :blocked_reason_type do |r|%>
          <div class="radio-buttons">
            <% BlockedReasonType.all.each do |reason| %>
              <div class="field">
                <%= r.radio_button :id, reason[:id] %>
                <%= r.label :id, reason[:name], value: reason[:id] %>
              </div>
            <% end %>
          </div>
        <% end %>
      </div>
      <div class="blocked-field-group-right">
        <div class="field">
          <%= f.label ' Comment:' %><br />
          <%= f.text_area :comment, size: "15x3" %>
        </div>
        <div class="actions">
          <%= f.submit %>
          <%=  button_tag(type: 'button', id: 'block_form_hide_button') do %>
            <%= content_tag(:strong, 'Cancel') %>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
<% else %>
  <%= "#{issue.blocked_reason.blocked_reason_type.name}: #{issue.blocked_reason.comment}" %>
<% end %>
<% content_for :header_tags do %>
  <%= stylesheet_link_tag 'tipr', plugin: :redmine_blocked_reason %>
  <%= stylesheet_link_tag 'blocked_reason', plugin: :redmine_blocked_reason %>
  <%= javascript_include_tag 'tipr.min.js', plugin: :redmine_blocked_reason %>
  <%= javascript_include_tag 'blocked_reason', plugin: :redmine_blocked_reason %>
<% end %>
